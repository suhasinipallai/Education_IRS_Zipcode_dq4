)
enroll_gauge
enroll_gauge <- gauge(
value = sum(education_df_plus_3$Enrollment),
min = 0,
max = max(education_df_plus_3$Enrollment),
sectors = gaugeSectors(colors = "blue"),
label = "students"
)
enroll_gauge
grad_rate <- sum(education_df_plus_3$Graduation)
valueBox(grad_rate, icon = "grad_icon.ico")
grad_rate <- sum(education_df_plus_3$Graduation)
valueBox(grad_rate, icon = "grad_icon.ico")
suspension_rate <- sum(education_df_plus_3$Pct_Suspended) / 100
valueBox(suspension_rate, icon = "suspension_icon.jpg")
gr <- education_df_plus_3 %>%
group_by(CORE_region) %>%
summarize(
mean_act =mean(ACT_Composite),
mean_graduation = mean(Graduation),
mean_expelled = mean(Pct_Expelled),
mean_dropout = mean(Dropout),
mean_hispanic= mean(Pct_Hispanic),
mean_black = mean(Pct_Black),
mean_native_american = mean(Pct_Native_American)
)
ungroup() %>%
order(desc(mean_act))
gr <- education_df_plus_3 %>%
group_by(CORE_region) %>%
summarize(
mean_act =mean(ACT_Composite),
mean_graduation = mean(Graduation),
mean_expelled = mean(Pct_Expelled),
mean_dropout = mean(Dropout),
mean_hispanic= mean(Pct_Hispanic),
mean_black = mean(Pct_Black),
mean_native_american = mean(Pct_Native_American)
)
ungroup()
``` {r}
gr <- education_df_plus_3 %>%
group_by(CORE_region) %>%
summarize(
mean_act =mean(ACT_Composite),
mean_graduation = mean(Graduation),
mean_expelled = mean(Pct_Expelled),
mean_dropout = mean(Dropout),
mean_hispanic= mean(Pct_Hispanic),
mean_black = mean(Pct_Black),
mean_native_american = mean(Pct_Native_American)
) %>%
ungroup()
View(gr)
gr <- education_df_plus_3 %>%
group_by(CORE_region) %>%
summarize(
avg_act =mean(ACT_Composite),
avg_graduation = mean(Graduation),
avg_expelled = mean(Pct_Expelled),
avg_dropout = mean(Dropout),
avg_hispanic= mean(Pct_Hispanic),
avg_black = mean(Pct_Black),
avg_native_american = mean(Pct_Native_American)
) %>%
ungroup() %>%
select(CORE_region,avg_act,avg_graduation,avg_expelled,avg_dropout,avg_hispanic,avg_black,avg_native_american) %>%
arrange(desc(avg_act))
View(gr)
core_region_act <- education_df_plus_3 %>%
group_by(CORE_region) %>%
summarize(
avg_act =mean(ACT_Composite),
avg_graduation = mean(Graduation),
avg_expelled = mean(Pct_Expelled),
avg_dropout = mean(Dropout),
avg_hispanic= mean(Pct_Hispanic),
avg_black = mean(Pct_Black),
avg_native_american = mean(Pct_Native_American)
) %>%
ungroup() %>%
select(CORE_region,avg_act,avg_graduation,avg_expelled,avg_dropout,avg_hispanic,avg_black,avg_native_american) %>%
arrange(desc(avg_act))
core_region_act <- education_df_plus_3 %>%
group_by(CORE_region) %>%
summarize(
avg_act =mean(ACT_Composite),
avg_graduation = mean(Graduation),
avg_expelled = mean(Pct_Expelled),
avg_dropout = mean(Dropout),
avg_hispanic= mean(Pct_Hispanic),
avg_black = mean(Pct_Black),
avg_native_american = mean(Pct_Native_American)
) %>%
ungroup() %>%
select(CORE_region,avg_act,avg_graduation,avg_expelled,avg_dropout,avg_hispanic,avg_black,avg_native_american) %>%
arrange(desc(avg_act)) %>%
ggplot(aes(x=CORE_region,y=avg_act)) +
geom_bar()
core_region_act <- education_df_plus_3 %>%
group_by(CORE_region) %>%
summarize(
avg_act =mean(ACT_Composite),
avg_graduation = mean(Graduation),
avg_expelled = mean(Pct_Expelled),
avg_dropout = mean(Dropout),
avg_hispanic= mean(Pct_Hispanic),
avg_black = mean(Pct_Black),
avg_native_american = mean(Pct_Native_American)
) %>%
ungroup() %>%
select(CORE_region,avg_act,avg_graduation,avg_expelled,avg_dropout,avg_hispanic,avg_black,avg_native_american) %>%
arrange(desc(avg_act))
p <-  ggplot(data=core_region_act,aes(x=CORE_region,y=avg_act)) +
geom_bar()
core_region_act <- education_df_plus_3 %>%
group_by(CORE_region) %>%
summarize(
avg_act =mean(ACT_Composite),
avg_graduation = mean(Graduation),
avg_expelled = mean(Pct_Expelled),
avg_dropout = mean(Dropout),
avg_hispanic= mean(Pct_Hispanic),
avg_black = mean(Pct_Black),
avg_native_american = mean(Pct_Native_American)
) %>%
ungroup() %>%
select(CORE_region,avg_act,avg_graduation,avg_expelled,avg_dropout,avg_hispanic,avg_black,avg_native_american) %>%
arrange(desc(avg_act))
p <-  ggplot(data=core_region_act,aes(x=CORE_region,y=avg_act)) +
geom_bar()
p
core_region_act <- education_df_plus_3 %>%
group_by(CORE_region) %>%
summarize(
avg_act =mean(ACT_Composite),
avg_graduation = mean(Graduation),
avg_expelled = mean(Pct_Expelled),
avg_dropout = mean(Dropout),
avg_hispanic= mean(Pct_Hispanic),
avg_black = mean(Pct_Black),
avg_native_american = mean(Pct_Native_American)
) %>%
ungroup() %>%
select(CORE_region,avg_act,avg_graduation,avg_expelled,avg_dropout,avg_hispanic,avg_black,avg_native_american) %>%
arrange(desc(avg_act))
p <-  ggplot(data=core_region_act,aes(x=CORE_region)) +
geom_bar()
p
p <-  ggplot(data=core_region_act,aes(x=CORE_region ,fill=avg_act)) +
geom_bar()
p
View(core_region_act)
p <-  ggplotot(data=core_region_act,aes(x=CORE_region ,fill=avg_act)) +
geom_histogram()
p <-  ggplot(data=core_region_act,aes(x=CORE_region ,fill=avg_act)) +
geom_histogram()
p
p <-  ggplot(data=core_region_act,aes(x=CORE_region ,fill=avg_act)) +
geom_col()
p
p <-  ggplot(data=core_region_act,aes(x=CORE_region ,y=avg_act)) +
geom_col()
p
p <-  ggplot(data=core_region_act,aes(x=CORE_region ,y=avg_act)) +
geom_col()
ggplotly(p)
p <-  ggplot(data=core_region_act,aes(x=CORE_region ,y=avg_act,fill=avg_act)) +
geom_col()
ggplotly(p)
p <-  ggplot(data=core_region_act,aes(x=CORE_region ,y=avg_act,fill=avg_act,avg_graduation)) +
geom_col()
ggplotly(p)
p <-  ggplot(data=core_region_act,aes(x=CORE_region ,y=avg_act,fill=avg_graduation)) +
geom_col()
ggplotly(p)
?ggplot
p <-  ggplot(data=core_region_act,aes(x=CORE_region ,y=avg_act,fill=avg_graduation)) +
geom_bar(stat = "identity")
ggplotly(p)
p <-  ggplot(data=core_region_act,aes(x=CORE_region ,y=avg_act,fill=avg_graduation)) +
geom_bar(stat = "identity",position = "dodge")
ggplotly(p)
p <-  ggplot(data=core_region_act,aes(x=CORE_region ,y=avg_act,fill=avg_graduation,color="yellow")) +
geom_bar(stat = "identity",position = "dodge")
ggplotly(p)
p <-  ggplot(data=core_region_act,aes(x=CORE_region ,y=avg_act,fill=avg_graduation,col="yellow")) +
geom_bar(stat = "identity",position = "dodge")
ggplotly(p)
p <-  ggplot(data=core_region_act,aes(x=CORE_region ,y=avg_act,fill=avg_graduation)) +
geom_bar(stat = "identity",position = "dodge")
ggplotly(p)
p <-  ggplot(data=core_region_act,aes(x=CORE_region ,y=avg_act,fill=avg_graduation,color=avg_dropout)) +
geom_bar(stat = "identity",position = "dodge")
ggplotly(p)
View(core_region_act)
?melt
?melt
?melt()
melt_m <- melt(data=core_region_act,id.vars = "CORE_region")
View(melt_m)
View(melt_m)
View(melt_m)
melt_core <- melt(data=core_region_act,id.vars = "CORE_region")
p1 <- ggplot(data=melt_core,aes(x=Core_region , y=valuegroup=variable,color=variable)) +
melt_core <- melt(data=core_region_act,id.vars = "CORE_region")
p1 <- ggplot(data=melt_core,aes(x=Core_region , y=value ,group = variable,color=variable)) +
geom_col()
p1
melt_core <- melt(data=core_region_act,id.vars = "CORE_region")
p1 <- ggplot(data=melt_core,aes(x=CORE_region , y=value ,group = variable,color=variable)) +
geom_col()
p1
p1 <- ggplot(data=melt_core,aes(x=CORE_region , y=value ,group = variable,color=variable)) +
geom_col()
ggplotly(p1)
melt_core <- melt(data=core_region_act,id.vars = "CORE_region")
p1 <- ggplot(data=melt_core,aes(x=CORE_region , y=value ,group = variable,color=variable)) +
geom_col()
ggplotly(p1)
melt_core <- melt(data=core_region_act,id.vars = "CORE_region")
p1 <- ggplot(data=melt_core,aes(x=CORE_region , y=value ,group = c(CORE_region,variable),color=variable)) +
geom_col()
ggplotly(p1)
p1 <- ggplot(data=melt_core,aes(x=CORE_region , y=value ,group = c("CORE_region","variable""),color=variable)) +
geom_col()
ggplotly(p1)
ggplotly(p1)
p1 <- ggplot(data=melt_core,aes(x=CORE_region , y=value ,group = variable,color=variable)) +
geom_col()
ggplotly(p1)
p1 <- ggplot(data=melt_core,aes(x=CORE_region ,y=value, group = variable , color=variable)) +
geom_col()
ggplotly(p1)
melt_core <- melt(data=core_region_act,id.vars = "CORE_region")
melt_core <- melt(data=core_region_act,id.vars ="CORE_region")
p1 <- ggplot(data=melt_core,aes(x=CORE_region,y=value,group=variable,color=variable)) +
geom_col()
melt_core <- melt(data=core_region_act,id.vars ="CORE_region")
p1 <- ggplot(data=melt_core,aes(x=CORE_region,y=value,group=variable,color=variable)) +
geom_col()
ggplotly(p1)
p1 <- ggplot(data=melt_core,aes(x=CORE_region,y=value,color=variable)) +
geom_point() +
geom_smooth(method="lm")
ggplotly(p1)
p1 <- ggplot(data=melt_core,aes(x=CORE_region,y=value,color=variable)) +
geom_point() +
geom_smooth(method='lm')
ggplotly(p1)
p1 <-education_df_plus_3 %>%
create_hist('Graduation', c(-Inf, 81, 91, 95, Inf), c('#B82601', '#6D7993', '#062F4F', '#6D7993'), 'grad vs count','Graduation Rate','Count Freq')
ggplotly(p1)
library(flexdashboard)
irs_2011_2015 <- readRDS('./r-objects/irs_2011_2015.rds')
ggplot_num_returns <- function(df, range, y.label="", point=FALSE) {
df_sort_1 <- irs_2011_2015 %>%
dplyr::filter(sum_total_income_returns >= range) %>%
dplyr::select(
county, year, sum_total_income_returns
)
p <- df_sort_1 %>%
ggplot(
aes(
x = year,
y = sum_total_income_returns,
group = county,
color = county
)
) +
geom_line(size = 1.5) +
labs(y = y.label, x = "") +
theme(axis.text.x = element_text(
face = 'bold',
size = 14
)
) +
theme(axis.text.y = element_text(
face = 'bold',
size = 14
)
) +
theme(axis.title.y = element_text(
size = 20
)
) +
scale_y_continuous(labels = scales::comma) +
scale_color_hue(l = 60, c = 50)
if (point) {
p +
geom_point() +
geom_label(
aes(label=sum_total_income_returns),
hjust = 0,
vjust = 0,
nudge_x = -.5,
nudge_y = .2
)
} else {
p
}
}
ggplot_num_returns(irs_2011_2015, 20000, y.label = "Num of Tax Payers Per Year")
p1 <- ggplot_num_returns(irs_2011_2015, 20000, y.label = "Num of Tax Payers Per Year")
ggplotly(p1)
p_plotly <- plot_ly(
data = melt_core,
x = ~ CORE_region,
y = ~ value,
type = "bar",
name = "value",
color = "red5"),
p_plotly <- plot_ly(
data = melt_core,
x = ~ CORE_region,
y = ~ value,
type = "bar",
name = "value",
color = "red5",
alpha = 0.75
) %>%
add_bars(
y = ~ value,
name = "Approached",
color = "orange3"
) %>%
add_bars(
y = ~ value,
name = "Enrolled",
color = "green4"
)
p_plotly %>%
layout(legend = list(x = 0, y = 0.95, bgcolor='transparent'),
xaxis = x_screen, yaxis = y)
p_plotly <- plot_ly(
data = melt_core,
x = ~ CORE_region,
y = ~ value,
type = "bar",
name = "value",
color = "red5",
alpha = 0.75
) %>%
add_bars(
y = ~ value,
name = "Approached",
color = "orange3"
) %>%
add_bars(
y = ~ value,
name = "Enrolled",
color = "green4"
)
p_plotly %>%
layout(legend = list(x = 0, y = 0.95, bgcolor='transparent')
)
p1 <- ggplot(data=melt_core,aes(x=CORE_region,y=value,color=variable)) +
geom_point() +
geom_smooth(method='lm')  +
scale_size_continuous(range = c(3,8))
ggplotly(p1)
p1 <- ggplot(data=melt_core,aes(x=CORE_region,y=value,color=variable)) +
geom_point() +
geom_smooth(method='lm')  +
scale_size_continuous(range = c(5,12))
ggplotly(p1)
grad_rate <- sum(education_df_plus_3$Graduation)/100
valueBox(grad_rate, icon = "grad_icon.ico")
suspension_rate <- sum(education_df_plus_3$Pct_Suspended) / 100
valueBox(suspension_rate,
icon = "suspension_icon.jpg",
color= ifelse(suspension_rate > 5 , "warning","primary"))
expelled_rate <- sum(education_df_plus_3$Pct_Expelled)/100
valueBox(expelled_rate,
icon = "fa-trash",
color = ifelse(expelled_rate > 5, "warning", "primary"))
library(flexdashboard)
library("MASS")
library("dplyr")
library("ggplot2")
library("grid")
library("stringr")
library("reshape2")
library("plotly")
library("dygraphs")
library("metricsgraphics")
p1 <- ggplot(data=melt_core,aes(x=CORE_region,y=value,color=variable)) +
geom_point() +
geom_smooth(method='lm')  +
scale_size_continuous(range = c(5,12))+
geom_text(size=2)
p1 <- ggplot(data=melt_core,aes(x=CORE_region,y=value,color=variable)) +
geom_point() +
geom_smooth(method='lm')  +
scale_size_continuous(range = c(5,12))+
geom_text(size=2)
ggplotly(p1)
p1 <- ggplot(data=melt_core,aes(x=CORE_region,y=value,color=variable)) +
geom_point() +
geom_smooth(method='lm')  +
scale_size_continuous(range = c(5,12))+
geom_text(size=2,aes(label=name))
ggplotly(p1)
p1 <- ggplot(data=melt_core,aes(x=CORE_region,y=value,color=variable)) +
geom_point() +
geom_smooth(method='lm')  +
scale_size_continuous(range = c(5,12))+
geom_text(size=2,aes(label=value))
ggplotly(p1)
p1 <- ggplot(data=melt_core,aes(x=CORE_region,y=value,color=variable)) +
geom_point() +
geom_smooth(method='lm')  +
scale_size_continuous(range = c(5,12))+
geom_text(size=2,aes(label=value))
ggplotly(p1)
valueBox(42, caption = "Dropouts", icon="fa-thumbs-down")
valueBox(107, caption = "Suspension", icon="fa-tag")
valueBox(247, caption = "Graduation", icon="fa-random")
suspension_rate <- sum(education_df_plus_3$Pct_Suspended) / 100
valueBox(suspension_rate,
icon = "suspension_icon.jpg",
color= ifelse(suspension_rate > 5 , "warning","primary"))
grad_rate <- sum(education_df_plus_3$Graduation)/100
grad_rate1 <- mean(education_df_plus_3$Graduation)
grad_rate <- sum(education_df_plus_3$Graduation)/100
grad_rate1 <- mean(education_df_plus_3$Graduation)
valueBox(grad_rate, caption = "", icon = 'grad_icon.ico', color = "pink", href = NULL)
grad_rate <- sum(education_df_plus_3$Graduation)/100
grad_rate1 <- mean(education_df_plus_3$Graduation)
grad_rate1
valueBox(grad_rate, caption = "", icon = 'grad_icon.ico', color = "pink", href = NULL)
grad_rate <- sum(education_df_plus_3$Graduation)/100
grad_rate1 <- mean(education_df_plus_3$Graduation)
grad_rate1
grad_rate
valueBox(grad_rate, caption = "", icon = 'grad_icon.ico', color = "pink", href = NULL)
grad_rate1 <- paste0(round(max(education_df_plus_3$Graduation),2)," %")
valueBox(grad_rate1, caption = "Average Graduation Rate in TN", icon = 'grad_icon.ico', color = "blue", href = NULL)
act_score <- paste0(round(max(education_df_plus_3$ACT_Composite)), " for 36")
valueBox(act_score, caption = "Avg 2014 ACT Scores in TN ", icon = 'suspension_icon.jpg', color = "green", href = NULL)
suspension_rate <- paste0(round(max(education_df_plus_3$Pct_Suspended),2), " %")
valueBox(suspension_rate, caption = "Avg Suspension Rate in TN", icon = 'suspension_icon.jpg', color = "red", href = NULL)
View(zip_irs_education_df)
# Read in education data and irs/zip codes data
# './scripts/education.R'
# './scripts/merge-zip-codes-irs-2014.R'
education <- readRDS('./r-objects/education_merge_irs_zip_subset.rds')
zip_codes_irs_df_by_county <- readRDS('./r-objects/zip_codes_irs_df_by_county.rds')
# Merge both irs and zip codes data by zip
zip_irs_education_df <- merge(education, zip_codes_irs_df_by_county, by = 'county')
View(zip_irs_education_df)
# Save off df for use later on
saveRDS(zip_irs_education_df, './r-objects/zip_irs_education_df.rds')
write.csv(zip_irs_education_df, './r-objects/zip_irs_education_df.csv')
View(education_df_plus_3)
education_df_plus_3 %>% group_by(CORE_region) %>%
summarise(m = mean(Per_Pupil_Expenditures)) %>%
ungroup()
ungroup() %>%  select(CORE_Region,m)
m <- education_df_plus_3 %>%
group_by(CORE_region) %>%
summarise(
mean_pupil_amt = mean(Per_Pupil_Expenditures)
) %>%
ungroup() %>%
select(CORE_region,mean_pupil_amt)
m <- education_df_plus_3 %>%
group_by(CORE_region) %>%
summarise(
mean_pupil_amt = mean(Per_Pupil_Expenditures)
) %>%
ungroup() %>%
select(CORE_region,mean_pupil_amt)
m
m <- education_df_plus_3 %>%
group_by(CORE_region) %>%
summarise(
mean_pupil_amt = mean(Per_Pupil_Expenditures)
) %>%
ungroup() %>%
select(CORE_region,mean_pupil_amt) %>%
arrange(desc(mean_pupil_amt))
m
install.packages("DT")
library(flexdashboard)
library("MASS")
library("dplyr")
library("ggplot2")
library("grid")
library("stringr")
library("reshape2")
library("plotly")
library("dygraphs")
library("metricsgraphics")
library("DT")
mean_pupil_exp_vs_core_region <- education_df_plus_3 %>%
group_by(CORE_region) %>%
summarise(
mean_pupil_exp = mean(Per_Pupil_Expenditures)
) %>%
ungroup() %>%
select(CORE_region,mean_pupil_amt) %>%
arrange(desc(mean_pupil_amt))
mean_pupil_exp_vs_core_region <- education_df_plus_3 %>%
group_by(CORE_region) %>%
summarise(
mean_pupil_exp = round(mean(Per_Pupil_Expenditures),2)
) %>%
ungroup() %>%
select(CORE_region,mean_pupil_exp) %>%
arrange(desc(mean_pupil_exp))
